/* --- REMRIN "CINEMATIC DARK" THEME ðŸŒ‘âœ¨ --- */
:root {
    --bg-color: #262a3a;
    --sidebar-bg: #1f2230;
    --text-color: #ffffff;
    --accent-blue: #236ce1;
    --accent-pink: #de5ba7;
    --user-msg-bg: rgba(35, 108, 225, 0.85);
    --ai-msg-bg: rgba(20, 20, 30, 0.9);
    --border-color: rgba(255,255,255,0.1);
}

/* DYNAMIC VIEWPORT HEIGHT (dvh) FIX FOR MOBILE BROWSERS */
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; display: flex; height: 100dvh; color: var(--text-color); background: var(--bg-color); overflow: hidden; }

/* SCROLLBARS */
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: #444; border-radius: 4px; }
::-webkit-scrollbar-thumb:hover { background: var(--accent-blue); }

/* --- SIDEBAR (Desktop Default) --- */
#sidebar { 
    width: 320px; background: var(--sidebar-bg); border-right: 1px solid var(--border-color); 
    display: flex; flex-direction: column; z-index: 3000; 
    box-shadow: 5px 0 30px rgba(0,0,0,0.6); transition: margin-left 0.4s ease-in-out; position: relative;
}
#sidebar.collapsed { margin-left: -320px; } 

/* CHEVRON CLOSE BUTTON (Inside Sidebar) */
#close-sidebar-btn {
    position: absolute; top: 15px; right: 15px; 
    background: transparent; color: var(--accent-pink); border: 1px solid rgba(222, 91, 167, 0.3);
    width: 30px; height: 30px; border-radius: 50%; cursor: pointer;
    font-size: 1.2rem; line-height: 28px; text-align: center; padding: 0; transition: 0.3s; z-index: 51;
}
#close-sidebar-btn:hover { background: var(--accent-pink); color: white; }

.brand-header { padding: 30px 20px; text-align: center; background: rgba(0,0,0,0.2); border-bottom: 1px solid var(--border-color); cursor: pointer; }
.brand-logo { max-width: 160px; filter: drop-shadow(0 0 10px rgba(35, 108, 225, 0.5)); transition: transform 0.2s; }
.brand-header:active .brand-logo { transform: scale(0.95); }

#roster-list { padding: 15px; overflow-y: auto; flex: 1; display: flex; flex-direction: column; gap: 10px; }

.character-card { display: flex; align-items: center; gap: 12px; padding: 10px; border-radius: 10px; cursor: pointer; transition: 0.2s; background: rgba(255,255,255,0.03); border: 1px solid transparent; }
.character-card:hover { background: rgba(255,255,255,0.08); transform: translateX(5px); }
.character-card.active { border: 1px solid var(--accent-pink); background: linear-gradient(90deg, rgba(222, 91, 167, 0.2) 0%, rgba(0,0,0,0) 100%); }
.avatar-small { width: 45px; height: 45px; border-radius: 50%; object-fit: cover; border: 2px solid #555; }

/* --- MAIN CHAT --- */
#main-chat { flex: 1; display: flex; flex-direction: column; background-color: var(--bg-color); background-size: cover; background-position: center; position: relative; transition: 0.3s; }
#chat-overlay { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.3); z-index: 0; pointer-events: none; }
#hero-standing { position: absolute; bottom: 0; left: 5%; height: 90vh; max-height: 900px; width: auto; z-index: 1; filter: drop-shadow(0 0 20px rgba(0,0,0,0.5)); pointer-events: none; }

/* GLASS COLUMN */
.chat-container {
    position: relative; z-index: 2; width: 45%; max-width: 600px; margin-left: auto; margin-right: 0; height: 100%;
    display: flex; flex-direction: column; background: linear-gradient(90deg, rgba(0,0,0,0) 0%, rgba(0,0,0,0.6) 30%, rgba(0,0,0,0.85) 100%);
    border-left: 1px solid rgba(255,255,255,0.05); backdrop-filter: blur(4px);
}

#chat-header { padding: 20px 30px; display: flex; align-items: center; border-bottom: 1px solid rgba(255,255,255,0.05); min-height: 60px; }

/* HIDE HAMBURGER FOREVER */
#open-sidebar-btn { display: none !important; }

/* New Back to Voice Button */
#back-to-voice-btn { display: none; background: none; border: none; font-size: 1.5rem; cursor: pointer; margin-right: 15px; }

#current-hero-img { width: 50px; height: 50px; border-radius: 12px; object-fit: cover; border: 2px solid var(--accent-pink); margin-right: 15px; }

#messages { flex: 1; padding: 20px 30px; overflow-y: auto; display: flex; flex-direction: column; gap: 15px; }
.message { max-width: 85%; padding: 15px 20px; border-radius: 18px; line-height: 1.5; position: relative; box-shadow: 0 2px 5px rgba(0,0,0,0.2); font-size: 1rem; backdrop-filter: blur(10px); }
.message.user { align-self: flex-end; background: var(--user-msg-bg); color: white; border-bottom-right-radius: 2px; }
.message.ai { align-self: flex-start; background: var(--ai-msg-bg); border-bottom-left-radius: 2px; border: 1px solid rgba(255,255,255,0.1); }

/* INPUT AREA - FIXED FOR KEYBOARD */
#input-area { padding: 20px; background: rgba(0,0,0,0.4); display: flex; gap: 10px; border-top: 1px solid rgba(255,255,255,0.1); }
#user-input { flex: 1; padding: 15px; border-radius: 10px; background: rgba(255,255,255,0.1); color: white; border: 1px solid rgba(255,255,255,0.2); outline: none; }
#user-input:focus { background: rgba(0,0,0,0.6); border-color: var(--accent-blue); }
#send-btn { background: var(--accent-blue); color: white; border: none; padding: 0 20px; border-radius: 10px; cursor: pointer; font-weight: bold; text-transform: uppercase; }

/* BUTTONS */
.sidebar-btn { width: 100%; padding: 12px; background: rgba(255,255,255,0.05); color: #aaa; border: 1px solid #333; border-radius: 8px; cursor: pointer; margin-top: 10px; text-align: left; padding-left: 20px; }
.sidebar-btn:hover { background: rgba(255,255,255,0.1); color: white; }
.market-btn { margin-top: auto; background: linear-gradient(90deg, rgba(35, 108, 225, 0.2), rgba(222, 91, 167, 0.2)); border: 1px solid var(--accent-pink); color: white; font-weight: bold; }
.market-btn:hover { box-shadow: 0 0 15px rgba(222, 91, 167, 0.4); }

/* MODAL */
#api-modal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #1f2230; padding: 30px; border-radius: 15px; border: 2px solid var(--accent-blue); z-index: 3100; width: 350px; color: white; }
#overlay-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 3099; }
.speak-btn { position: absolute; bottom: -25px; right: 0; background: none; border: none; font-size: 1.2rem; cursor: pointer; opacity: 0.6; filter: grayscale(100%); transition: 0.3s; }
.speak-btn:hover { opacity: 1; filter: none; transform: scale(1.2); }

/* INSTALL TOAST (DISMISSIBLE) */
#install-toast { 
    display: none; 
    position: fixed; 
    top: 20px; 
    left: 50%; 
    transform: translateX(-50%); 
    background: var(--accent-pink); 
    color: white; 
    padding: 8px 15px; 
    border-radius: 30px; 
    z-index: 4000; 
    box-shadow: 0 5px 20px rgba(0,0,0,0.5); 
    font-weight: bold; 
    animation: slideDown 0.5s ease; 
    align-items: center; 
    gap: 10px; 
    cursor: pointer;
}
@keyframes slideDown { from { top: -50px; } to { top: 20px; } }

.toast-content { display: flex; align-items: center; gap: 8px; }
.toast-close { background: none; border: none; color: white; font-size: 16px; cursor: pointer; padding: 0 5px; opacity: 0.8; border-left: 1px solid rgba(255,255,255,0.3); margin-left: 5px; }
.toast-close:hover { opacity: 1; }

/* SETTINGS INPUTS */
.settings-input { width:100%; padding:10px; margin:10px 0; background:#111; border:1px solid #444; color:white; border-radius:5px; box-sizing: border-box; }
.settings-select { width:100%; padding:10px; margin:10px 0; background:#111; border:1px solid #444; color:white; border-radius:5px; cursor: pointer; }

/* --- PORTRAIT LOCK OVERLAY --- */
#portrait-lock { display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: #000; z-index: 9999; color: white; flex-direction: column; align-items: center; justify-content: center; text-align: center; }

@media (max-width: 800px) {
    .chat-container { width: 100%; max-width: none; background: rgba(0,0,0,0.6); }
}

/* --- MOBILE STYLES (Overrides) --- */
.mobile-only { display: none; }

/* CRITICAL DESKTOP FIX: HIDE MOBILE TOGGLE ON DESKTOP */
/* This kills the Ghost Bar */
.mobile-nav-toggle { display: none; }

/* FORCE PORTRAIT LOCK ON LANDSCAPE MOBILE */
@media screen and (orientation: landscape) and (max-height: 600px) {
    #portrait-lock { display: flex !important; }
}

@media screen and (max-width: 768px) {
    /* Layout Reset */
    body { overflow: hidden; }

    /* Hero Image Fixed */
    .hero-background { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: 0; background-position: center; background-size: cover; }

    /* Sidebar Drawer - Z-INDEX 3000 (Top) */
    #sidebar { 
        position: fixed !important; 
        left: -100% !important; /* START CLOSED */
        margin-left: 0 !important; /* Reset desktop margins */
        top: 0; 
        width: 85% !important; /* Narrower width */
        max-width: 300px;
        height: 100%; 
        background: rgba(15, 15, 20, 0.98); 
        z-index: 3000; 
        transition: left 0.3s cubic-bezier(0.4, 0.0, 0.2, 1); 
        box-shadow: 10px 0 50px rgba(0,0,0,0.8); 
        backdrop-filter: blur(15px); 
    }
    #sidebar.active { left: 0 !important; }

    /* Close Button inside Sidebar needs high z-index */
    #close-sidebar-btn { z-index: 3001; }

    /* Chat Column */
    .chat-container { width: 100% !important; height: 100% !important; margin: 0; border-radius: 0; background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(5px); border: none; position: relative; z-index: 10; }
    
    /* Hide Chat in Voice Mode */
    .main-container.voice-mode .chat-container { display: none !important; }

    /* Show Back to Voice Button */
    #back-to-voice-btn { display: block; }

    /* Mobile Nav Toggle (PINK CHEVRON) - MOVED TO RIGHT TO AVOID AVATAR */
    .mobile-nav-toggle { 
        display: flex !important; /* Force Show on Mobile */
        position: fixed; 
        top: 15px; 
        right: 15px; /* MOVED TO RIGHT */
        left: auto; /* Reset Left */
        z-index: 3005; /* HIGHER THAN EVERYTHING */
        background: rgba(0,0,0,0.6); 
        border: 2px solid var(--accent-pink); 
        color: var(--accent-pink); 
        border-radius: 50%; 
        width: 45px; 
        height: 45px; 
        align-items: center; 
        justify-content: center; 
        font-size: 24px; 
        font-weight: bold;
        cursor: pointer; 
        backdrop-filter: blur(5px);
        box-shadow: 0 0 15px rgba(0,0,0,0.5);
        transition: transform 0.2s;
    }
    .mobile-nav-toggle:active { transform: scale(0.9); background: var(--accent-pink); color: white; }

    /* VOICE INTERFACE OVERLAY */
    .mobile-only { display: block; }
    #mobile-voice-interface {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 2000;
        pointer-events: none; display: flex; flex-direction: column; justify-content: space-between;
        padding: 20px; box-sizing: border-box;
    }
    .voice-controls, .voice-header { pointer-events: auto; }
    
    /* Status Indicator (Top Right - Pushed Left by Button) */
    .voice-header { display: flex; justify-content: flex-start; padding-top: 10px; }
    .status-indicator { background: rgba(0,0,0,0.6); padding: 6px 14px; border-radius: 20px; font-size: 13px; display: flex; align-items: center; gap: 6px; color: #00ff88; border: 1px solid rgba(0,255,136,0.2); }
    .dot { width: 8px; height: 8px; background: #00ff88; border-radius: 50%; }
    .dot.live { animation: blink 1s infinite; }

    /* Bottom Controls Alignment */
    .voice-controls { 
        display: flex; 
        align-items: flex-end; 
        justify-content: space-between; 
        margin-bottom: 20px;
        padding-bottom: 40px; 
        position: relative;
    }
    
    .icon-btn { background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); color: white; width: 50px; height: 50px; border-radius: 50%; font-size: 20px; cursor: pointer; display: flex; align-items: center; justify-content: center; }
    .icon-btn:active { transform: scale(0.9); background: rgba(255,255,255,0.2); }

    /* THE ORB */
    .orb-container { position: relative; width: 90px; height: 90px; display: flex; justify-content: center; align-items: center; margin-bottom: 10px; cursor: pointer; transition: transform 0.1s; }
    .orb-core { width: 70px; height: 70px; background: linear-gradient(135deg, #00C6FF, #0072FF); border-radius: 50%; box-shadow: 0 0 25px rgba(0, 198, 255, 0.6); z-index: 2; animation: breathe 3s infinite ease-in-out; transition: 0.3s; }
    .orb-glow { position: absolute; width: 100%; height: 100%; background: rgba(0, 198, 255, 0.3); border-radius: 50%; z-index: 1; animation: pulse-ring 2s infinite; }
    
    /* ACTIVE (PRESSED) STATE - RAM PINK */
    .orb-container.active .orb-core { background: linear-gradient(135deg, #de5ba7, #ff7eb3); box-shadow: 0 0 35px rgba(222, 91, 167, 0.8); transform: scale(1.1); }
    .orb-container.active .orb-glow { background: rgba(222, 91, 167, 0.4); animation: none; transform: scale(1.3); }

    /* Status Text (Bottom Center) */
    .voice-status-text { 
        position: absolute; 
        bottom: 30px; 
        left: 0; 
        width: 100%; 
        text-align: center; 
        color: rgba(255, 255, 255, 0.6); 
        font-family: 'Courier New', monospace; 
        font-size: 12px; 
        letter-spacing: 3px; 
        text-transform: uppercase;
        pointer-events: none;
    }
}

/* --- THE JARVIS PROTOCOL (Video Backgrounds) --- */

/* 1. The Video Player Itself */
#bg-video {
    position: fixed;
    top: 0; 
    left: 0;
    width: 100%; 
    height: 100%;
    object-fit: cover;
    z-index: -1; /* Sit behind the chat */
    opacity: 0; /* Hidden by default */
    transition: opacity 1s ease;
    /* Ensure it doesn't block clicks when hidden */
    pointer-events: none; 
}

/* 2. When Video is Active (Visible) */
body.video-active #bg-video {
    opacity: 1; /* Show it! */
    pointer-events: auto;
}

/* 3. TEAR DOWN THE DRYWALL (Make backgrounds transparent) */
/* This forces the gray container to vanish so we see the video behind it */
body.video-active,
body.video-active .main-container,
body.video-active #main-chat {
    background: transparent !important;
    background-color: transparent !important;
    background-image: none !important;
}
@keyframes breathe { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
@keyframes pulse-ring { 0% { transform: scale(0.8); opacity: 0.5; } 100% { transform: scale(1.5); opacity: 0; } }
@keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
